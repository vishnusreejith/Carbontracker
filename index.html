<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>UniCarbon Tracker - Professional Edition</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons for high-quality visuals -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #f8fafc;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: contain;
        }

        /* Custom Range Slider Styling */
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #2563eb;
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .range-slider {
            -webkit-appearance: none;
            appearance: none;
            background: #e2e8f0;
            border-radius: 8px;
            height: 8px;
        }

        /* Modal Blur Effect */
        .modal-backdrop {
            backdrop-filter: blur(4px);
            background-color: rgba(15, 23, 42, 0.6);
        }

        .btn-active-primary {
            background-color: #1e293b !important;
            color: #ffffff !important;
            border-color: #1e293b !important;
        }

        .mode-active {
            border-color: #3b82f6 !important;
            background-color: #eff6ff !important;
            color: #1d4ed8 !important;
        }

        .day-active {
            background-color: #2563eb !important;
            color: #ffffff !important;
            border-color: #2563eb !important;
        }

        .animate-in {
            animation: fadeIn 0.2s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }

        .custom-scroll::-webkit-scrollbar {
            width: 4px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }

        input[type="text"] {
            font-size: 16px !important;
        }
    </style>
</head>
<body class="text-slate-900">

    <!-- Methodology Modal -->
    <div id="methodologyModal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-3 md:p-4 modal-backdrop">
        <div class="bg-white rounded-[2rem] w-full max-w-2xl max-h-[85vh] overflow-y-auto shadow-2xl animate-in">
            <div class="p-5 border-b border-slate-100 flex justify-between items-center sticky top-0 bg-white z-20">
                <h2 class="text-lg md:text-xl font-bold flex items-center gap-2">
                    <i data-lucide="book-open" class="text-blue-500 w-5 h-5 md:w-6 md:h-6"></i>
                    Estimation Equations
                </h2>
                <button onclick="toggleModal(false)" class="p-2 hover:bg-slate-100 rounded-full transition-colors active:scale-90">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            
            <div class="p-5 space-y-6 text-sm leading-relaxed text-slate-600">
                <!-- Variables Section -->
                <section>
                    <h3 class="font-bold text-slate-900 text-base mb-3">1. Personal Weekly Footprint (Ew)</h3>
                    <div class="bg-slate-50 p-4 rounded-2xl space-y-4 border border-slate-100">
                        <code class="text-blue-600 font-bold block bg-white p-3 rounded-lg border border-slate-200 overflow-x-auto text-xs text-center shadow-sm">
                            Ew = ((d × 2 × n) × EF × M) / O
                        </code>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2 text-[11px] border-t border-slate-100 pt-3">
                            <p><span class="font-bold text-blue-600 uppercase">d:</span> One-way distance (km)</p>
                            <p><span class="font-bold text-blue-600 uppercase">2:</span> Round-trip factor</p>
                            <p><span class="font-bold text-blue-600 uppercase">n:</span> Days per week</p>
                            <p><span class="font-bold text-blue-600 uppercase">EF:</span> Emission Factor (kg/km)</p>
                            <p><span class="font-bold text-blue-600 uppercase">M:</span> Vehicle Age Multiplier</p>
                            <p><span class="font-bold text-blue-600 uppercase">O:</span> Occupants (Carpool size)</p>
                        </div>
                    </div>
                </section>

                <section>
                    <h3 class="font-bold text-slate-900 text-base mb-3">2. Annual Projections</h3>
                    <div class="bg-slate-50 p-4 rounded-2xl space-y-3 border border-slate-100 text-[11px]">
                        <div class="flex justify-between items-center border-b border-white pb-2">
                            <span class="font-semibold text-slate-700">Yearly Impact:</span>
                            <code class="font-bold text-slate-900">Ew × 52 weeks</code>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-semibold text-slate-700">Nature Offset (Trees):</span>
                            <code class="font-bold text-emerald-600">(Yearly CO2) / 20</code>
                        </div>
                        <p class="text-[10px] text-slate-400 italic mt-2">*Calculation assumes one mature tree absorbs 20kg of CO2 per year.</p>
                    </div>
                </section>

                <section>
                    <h3 class="font-bold text-slate-900 text-base mb-3">3. Green Potential</h3>
                    <div class="bg-emerald-50 p-4 rounded-2xl border border-emerald-100 text-emerald-800 text-xs">
                        <p class="font-bold mb-1">Savings = Current Ew - EV Shuttle Ew</p>
                        <p>This reveals how much carbon is "erased" if you switch to the campus Electric Shuttle (which uses a high-efficiency 0.015 factor).</p>
                    </div>
                </section>

                <section>
                    <h3 class="font-bold text-slate-900 text-base mb-2">4. Emission Factors (EF) Table</h3>
                    <div class="overflow-x-auto rounded-xl border border-slate-100">
                        <table class="w-full text-left text-[10px] md:text-xs">
                            <thead class="bg-slate-50 text-slate-500 uppercase tracking-wider font-bold">
                                <tr>
                                    <th class="px-3 py-2">Category</th>
                                    <th class="px-3 py-2">Petrol</th>
                                    <th class="px-3 py-2">Diesel</th>
                                    <th class="px-3 py-2">Hybrid</th>
                                    <th class="px-4 py-2">EV</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100">
                                <tr><td class="px-3 py-2 font-bold">Compact</td><td class="px-3 py-2">0.150</td><td class="px-3 py-2">0.140</td><td class="px-3 py-2">0.080</td><td class="px-3 py-2">0.050</td></tr>
                                <tr><td class="px-3 py-2 font-bold">Sedan</td><td class="px-3 py-2">0.190</td><td class="px-3 py-2">0.180</td><td class="px-3 py-2">0.100</td><td class="px-3 py-2">0.050</td></tr>
                                <tr><td class="px-3 py-2 font-bold">SUV</td><td class="px-3 py-2">0.250</td><td class="px-3 py-2">0.240</td><td class="px-3 py-2">0.130</td><td class="px-3 py-2">0.050</td></tr>
                                <tr><td class="px-3 py-2 font-bold">Truck</td><td class="px-3 py-2">0.320</td><td class="px-3 py-2">0.300</td><td class="px-3 py-2">—</td><td class="px-3 py-2">0.050</td></tr>
                                <tr class="bg-slate-50/50"><td class="px-3 py-2 font-bold">Bike</td><td class="px-3 py-2">0.080</td><td class="px-3 py-2">—</td><td class="px-3 py-2">—</td><td class="px-3 py-2">0.020</td></tr>
                                <tr class="bg-slate-50/50"><td class="px-3 py-2 font-bold">Bus</td><td class="px-3 py-2">—</td><td class="px-3 py-2">0.040</td><td class="px-3 py-2">0.025</td><td class="px-3 py-2">0.015</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
            
            <div class="p-5 bg-slate-50 border-t border-slate-100">
                <button onclick="toggleModal(false)" class="w-full bg-slate-900 text-white font-bold py-3.5 rounded-2xl hover:bg-slate-800 transition-colors active:scale-[0.98]">
                    Understand Equations
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="min-h-screen p-3 md:p-8">
        <div class="max-w-6xl mx-auto">
            <!-- Header -->
            <header class="mb-6 md:mb-8 flex flex-col gap-4">
                <div class="flex items-center justify-between">
                    <h1 class="text-2xl md:text-3xl font-extrabold flex items-center gap-2">
                        <i data-lucide="shield-check" class="text-blue-600 w-7 h-7 md:w-8 md:h-8"></i>
                        <span>UniCarbon <span class="text-blue-600">Pro</span></span>
                    </h1>
                    <button onclick="toggleModal(true)" class="p-2.5 bg-white border border-slate-200 rounded-xl shadow-sm text-slate-400 hover:text-blue-500 transition-colors active:scale-90" title="Methodology">
                        <i data-lucide="info" class="w-5 h-5"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-blue-600 p-4 rounded-2xl shadow-lg shadow-blue-100 flex items-center justify-between text-white">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center">
                                <i data-lucide="bar-chart-3" class="w-5 h-5"></i>
                            </div>
                            <div>
                                <p class="text-[10px] font-bold uppercase tracking-widest leading-none mb-1 opacity-80 text-blue-100">Weekly CO2 Total</p>
                                <p class="text-xl font-extrabold" id="deptTotalWeekly">0.00 kg</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-emerald-600 p-4 rounded-2xl shadow-lg shadow-emerald-100 flex items-center justify-between text-white">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center">
                                <i data-lucide="leaf" class="w-5 h-5"></i>
                            </div>
                            <div>
                                <p class="text-[10px] font-bold uppercase tracking-widest leading-none mb-1 opacity-80 text-emerald-100">Green Potential</p>
                                <p class="text-xl font-extrabold" id="totalSavings">0.00 kg</p>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-5 md:gap-6">
                <!-- Entry Form -->
                <div class="lg:col-span-5 space-y-5">
                    <div class="bg-white rounded-3xl p-5 md:p-6 shadow-sm border border-slate-100">
                        <h2 class="text-base font-bold mb-5 flex items-center gap-2 text-slate-700">
                            <i data-lucide="user-plus" class="text-blue-500 w-4 h-4"></i>
                            Commuter Profile
                        </h2>
                        
                        <div class="space-y-5">
                            <div>
                                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 block">Name</label>
                                <input type="text" id="commuterName" placeholder="Staff or Student Name" class="w-full bg-slate-50 border border-slate-100 rounded-xl px-4 py-3 font-medium focus:ring-2 focus:ring-blue-500 focus:outline-none transition-all placeholder:text-slate-300">
                            </div>

                            <div>
                                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 block">Transport Mode</label>
                                <div class="grid grid-cols-3 gap-2 md:gap-3">
                                    <button onclick="updateState({vehicleType: 'car'})" id="mode-car" class="py-3 rounded-xl border-2 flex flex-col items-center gap-1.5 text-slate-400 border-slate-100 transition-all active:scale-95">
                                        <i data-lucide="car" class="w-5 h-5"></i>
                                        <span class="text-[9px] font-bold uppercase">Car</span>
                                    </button>
                                    <button onclick="updateState({vehicleType: 'motorcycle'})" id="mode-motorcycle" class="py-3 rounded-xl border-2 flex flex-col items-center gap-1.5 text-slate-400 border-slate-100 transition-all active:scale-95">
                                        <i data-lucide="bike" class="w-5 h-5"></i>
                                        <span class="text-[9px] font-bold uppercase">Bike</span>
                                    </button>
                                    <button onclick="updateState({vehicleType: 'bus'})" id="mode-bus" class="py-3 rounded-xl border-2 flex flex-col items-center gap-1.5 text-slate-400 border-slate-100 transition-all active:scale-95">
                                        <i data-lucide="bus" class="w-5 h-5"></i>
                                        <span class="text-[9px] font-bold uppercase">Bus</span>
                                    </button>
                                </div>
                            </div>

                            <div id="configOptions" class="space-y-5 bg-slate-50 p-4 rounded-2xl border border-slate-100">
                                <div>
                                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 block">Engine Type</label>
                                    <div class="flex flex-wrap gap-2" id="fuelSelector"></div>
                                </div>
                                <div id="sizeSection">
                                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 block">Vehicle Size</label>
                                    <div class="flex flex-wrap gap-2" id="sizeSelector"></div>
                                </div>
                                <div>
                                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 block">BS Norm / Standards</label>
                                    <div class="grid grid-cols-3 gap-1.5" id="ageSelector"></div>
                                </div>
                                <div id="occupancySection">
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Occupancy (People)</label>
                                        <span class="text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded text-[10px] font-extrabold" id="occupancyLabel">1 person</span>
                                    </div>
                                    <input type="range" id="occupancyInput" min="1" max="5" value="1" class="range-slider w-full cursor-pointer" oninput="updateState({occupancy: parseInt(this.value)})">
                                </div>
                            </div>

                            <div class="space-y-5">
                                <div>
                                    <div class="flex justify-between items-center mb-3">
                                        <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">One-way Distance</label>
                                        <span class="text-blue-600 font-bold text-xs" id="distanceLabel">10 km</span>
                                    </div>
                                    <input type="range" min="1" max="100" value="10" class="range-slider w-full cursor-pointer" oninput="updateState({distance: parseInt(this.value)})">
                                </div>
                                <div>
                                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3 block">Days per Week</label>
                                    <div class="flex justify-between gap-1" id="daySelector"></div>
                                </div>
                            </div>

                            <button onclick="addCommuter()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-extrabold py-4 rounded-2xl transition-all shadow-lg shadow-blue-100 flex items-center justify-center gap-2 active:scale-[0.97]">
                                <i data-lucide="plus-circle" class="w-5 h-5"></i>
                                Save Commuter
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Stats & Visual Records -->
                <div class="lg:col-span-7 space-y-5">
                    <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                        <div class="bg-white p-4 rounded-3xl shadow-sm border border-slate-100 text-center">
                            <p class="text-[9px] font-bold text-slate-400 uppercase mb-1">Total Users</p>
                            <p class="text-xl font-black text-slate-800" id="statCommuters">0</p>
                        </div>
                        <div class="bg-white p-4 rounded-3xl shadow-sm border border-slate-100 text-center">
                            <p class="text-[9px] font-bold text-slate-400 uppercase mb-1">Annual CO2</p>
                            <p class="text-xl font-black text-slate-800" id="statYearly">0 kg</p>
                        </div>
                        <div class="bg-emerald-50 p-4 rounded-3xl border border-emerald-100 text-center col-span-2 sm:col-span-1">
                            <p class="text-[9px] font-bold text-emerald-600 uppercase mb-1">Trees Needed</p>
                            <p class="text-xl font-black text-emerald-700" id="statTrees">0</p>
                        </div>
                    </div>

                    <div class="bg-white rounded-3xl shadow-sm border border-slate-100 flex flex-col h-[500px] md:h-[700px] overflow-hidden">
                        <div class="p-4 border-b border-slate-50 flex justify-between items-center bg-slate-50/50">
                            <h2 class="text-base font-bold flex items-center gap-2">
                                <i data-lucide="award" class="text-emerald-500 w-4 h-4"></i>
                                Record Breakdown
                            </h2>
                            <button onclick="clearList()" class="text-[10px] font-extrabold text-red-400 hover:text-red-500 uppercase tracking-widest active:scale-90">Reset List</button>
                        </div>
                        <div id="commuterList" class="flex-grow overflow-y-auto p-4 space-y-3 custom-scroll">
                            <div class="h-full flex flex-col items-center justify-center text-slate-300 opacity-60">
                                <i data-lucide="inbox" class="w-12 h-12"></i>
                                <p class="text-xs font-bold uppercase mt-2 text-center px-4">Add a team member to see the departmental impact</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="mt-8 text-center text-slate-400 text-[10px] font-bold uppercase tracking-widest pb-8">
                <p>© 2026 Campus Environmental registry • Global GHG Reporting Standards</p>
            </footer>
        </div>
    </div>

    <script>
        const EMISSION_FACTORS = {
            car: {
                gasoline: { compact: 0.15, sedan: 0.19, suv: 0.25, truck: 0.32 },
                diesel: { compact: 0.14, sedan: 0.18, suv: 0.24, truck: 0.30 },
                hybrid: { compact: 0.08, sedan: 0.10, suv: 0.13 },
                electric: { all: 0.05 }
            },
            motorcycle: {
                gasoline: { all: 0.08 },
                electric: { all: 0.02 }
            },
            bus: {
                diesel: { all: 0.04 },
                hybrid: { all: 0.025 },
                electric: { all: 0.015 }
            }
        };

        const AGE_MULTIPLIERS = {
            vintage: 1.30,
            classic: 1.00,
            modern: 0.85
        };

        let state = {
            vehicleType: 'car',
            fuelType: 'gasoline',
            size: 'sedan',
            age: 'classic',
            distance: 10,
            days: 5,
            occupancy: 1
        };

        let departmentCommuters = [];

        function init() {
            lucide.createIcons();
            updateUI();
        }

        function toggleModal(show) {
            const modal = document.getElementById('methodologyModal');
            modal.classList.toggle('hidden', !show);
            document.body.style.overflow = show ? 'hidden' : 'auto';
        }

        function updateState(newState) {
            state = { ...state, ...newState };
            if (!EMISSION_FACTORS[state.vehicleType][state.fuelType]) {
                state.fuelType = Object.keys(EMISSION_FACTORS[state.vehicleType])[0];
            }
            updateUI();
        }

        function getCommuterBadge(emissions, mode, occupants) {
            if (emissions < 5) return { icon: 'star', color: 'text-amber-500', label: 'Eco Legend' };
            if (occupants > 1) return { icon: 'users', color: 'text-blue-500', label: 'Shared Hero' };
            if (mode === 'bus') return { icon: 'bus', color: 'text-emerald-500', label: 'Transit Pro' };
            return { icon: 'user', color: 'text-slate-400', label: 'Commuter' };
        }

        function calculateGreenPotential(weekly, distance, days) {
            // Compare against the greenest option (Electric Bus: 0.015 kg/km)
            const greenestChoiceEmissions = (distance * 2 * days * 0.015);
            return Math.max(0, weekly - greenestChoiceEmissions);
        }

        function addCommuter() {
            const nameInput = document.getElementById('commuterName');
            const name = nameInput.value.trim() || `User #${departmentCommuters.length + 1}`;
            
            const modeData = EMISSION_FACTORS[state.vehicleType];
            const fuelData = modeData[state.fuelType];
            const factor = fuelData[state.size] || fuelData.all;

            const ageMult = AGE_MULTIPLIERS[state.age];
            const divisor = (state.vehicleType === 'bus') ? 1 : state.occupancy;
            
            const weekly = (state.distance * 2 * state.days * factor * ageMult) / divisor;
            const savings = calculateGreenPotential(weekly, state.distance, state.days);
            const badge = getCommuterBadge(weekly, state.vehicleType, state.occupancy);

            departmentCommuters.push({
                id: Date.now(),
                name,
                weekly,
                savings,
                badge,
                details: `${state.age.toUpperCase()} ${state.fuelType} ${state.vehicleType}`,
                dist: state.distance,
                days: state.days,
                occupancy: divisor
            });

            nameInput.value = '';
            renderCommuterList();
            updateDeptStats();
        }

        function clearList() {
            departmentCommuters = [];
            renderCommuterList();
            updateDeptStats();
        }

        function removeCommuter(id) {
            departmentCommuters = departmentCommuters.filter(c => c.id !== id);
            renderCommuterList();
            updateDeptStats();
        }

        function renderCommuterList() {
            const list = document.getElementById('commuterList');
            if (departmentCommuters.length === 0) {
                list.innerHTML = `<div class="h-full flex flex-col items-center justify-center text-slate-300 opacity-60"><i data-lucide="inbox" class="w-12 h-12"></i><p class="text-xs font-bold uppercase mt-2">No Records</p></div>`;
                lucide.createIcons();
                return;
            }

            list.innerHTML = departmentCommuters.slice().reverse().map(c => `
                <div class="bg-white border border-slate-100 rounded-2xl p-4 flex flex-col gap-3 animate-in shadow-sm hover:border-blue-100 transition-colors">
                    <div class="flex justify-between items-start">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-slate-50 rounded-xl flex items-center justify-center ${c.badge.color}">
                                <i data-lucide="${c.badge.icon}" class="w-5 h-5"></i>
                            </div>
                            <div>
                                <p class="font-bold text-slate-800 flex items-center gap-2">
                                    ${c.name} 
                                    <span class="text-[8px] px-1.5 py-0.5 bg-emerald-50 text-emerald-600 rounded-full font-black">${c.badge.label}</span>
                                </p>
                                <p class="text-[9px] text-slate-400 font-bold uppercase tracking-wider">${c.details} (${c.occupancy}p)</p>
                            </div>
                        </div>
                        <button onclick="removeCommuter(${c.id})" class="text-slate-300 hover:text-red-400 transition-colors"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                    </div>
                    <div class="flex justify-between items-center pt-2 border-t border-slate-50">
                        <div class="flex gap-4">
                            <div>
                                <p class="text-[8px] font-bold text-slate-400 uppercase leading-none mb-1">Weekly Footprint</p>
                                <p class="text-sm font-black text-slate-700">${c.weekly.toFixed(1)} kg</p>
                            </div>
                            <div>
                                <p class="text-[8px] font-bold text-emerald-400 uppercase leading-none mb-1">Green Potential</p>
                                <p class="text-sm font-black text-emerald-600">-${c.savings.toFixed(1)} kg</p>
                            </div>
                        </div>
                        <div class="text-right">
                             <p class="text-[8px] font-bold text-slate-400 uppercase leading-none mb-1">${c.dist}km / ${c.days}d</p>
                        </div>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        function updateDeptStats() {
            const totalWeekly = departmentCommuters.reduce((sum, c) => sum + c.weekly, 0);
            const totalSavings = departmentCommuters.reduce((sum, c) => sum + c.savings, 0);
            const totalYearly = totalWeekly * 52;
            const totalTrees = Math.ceil(totalYearly / 20);

            document.getElementById('deptTotalWeekly').innerText = `${totalWeekly.toFixed(2)} kg`;
            document.getElementById('totalSavings').innerText = `${totalSavings.toFixed(2)} kg`;
            document.getElementById('statCommuters').innerText = departmentCommuters.length;
            document.getElementById('statYearly').innerText = `${totalYearly.toFixed(0)} kg`;
            document.getElementById('statTrees').innerText = totalTrees;
        }

        function updateUI() {
            document.getElementById('sizeSection').style.display = (state.vehicleType === 'car' && state.fuelType !== 'electric') ? 'block' : 'none';
            document.getElementById('occupancySection').style.display = (state.vehicleType !== 'bus') ? 'block' : 'none';
            document.getElementById('occupancyLabel').innerText = `${state.occupancy} ${state.occupancy === 1 ? 'person' : 'people'}`;
            document.getElementById('distanceLabel').innerText = `${state.distance} km`;

            ['car', 'motorcycle', 'bus'].forEach(m => {
                const btn = document.getElementById(`mode-${m}`);
                btn.className = `py-3 rounded-xl border-2 flex flex-col items-center gap-1.5 transition-all ${state.vehicleType === m ? 'mode-active' : 'text-slate-400 border-slate-100'}`;
            });

            const fuelsCont = document.getElementById('fuelSelector');
            fuelsCont.innerHTML = Object.keys(EMISSION_FACTORS[state.vehicleType]).map(f => `
                <button onclick="updateState({fuelType: '${f}'})" class="px-2.5 py-1.5 rounded-lg text-[9px] font-bold border transition-all ${state.fuelType === f ? 'btn-active-primary' : 'bg-white text-slate-500 border-slate-200'}">
                    ${f.toUpperCase()}
                </button>
            `).join('');

            const sizesCont = document.getElementById('sizeSelector');
            sizesCont.innerHTML = ['compact', 'sedan', 'suv', 'truck'].map(s => `
                <button onclick="updateState({size: '${s}'})" class="px-2.5 py-1.5 rounded-lg text-[9px] font-bold border transition-all ${state.size === s ? 'btn-active-primary' : 'bg-white text-slate-500 border-slate-200'}">
                    ${s.toUpperCase()}
                </button>
            `).join('');

            const agesCont = document.getElementById('ageSelector');
            agesCont.innerHTML = ['vintage', 'classic', 'modern'].map(a => `
                <button onclick="updateState({age: '${a}'})" class="px-1.5 py-2 rounded-lg text-[8px] font-bold border transition-all text-center ${state.age === a ? 'btn-active-primary' : 'bg-white text-slate-500 border-slate-200'}">
                    ${a === 'vintage' ? 'BS-III' : a === 'classic' ? 'BS-IV/VI' : 'BS-VI.2'}
                </button>
            `).join('');

            const daysCont = document.getElementById('daySelector');
            daysCont.innerHTML = [1, 2, 3, 4, 5, 6, 7].map(d => `
                <button onclick="updateState({days: ${d}})" class="flex-1 py-2 text-[10px] font-black rounded-lg border-2 transition-all ${state.days === d ? 'day-active' : 'bg-white text-slate-400 border-slate-100'}">${d}</button>
            `).join('');
        }

        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
